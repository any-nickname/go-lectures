План занятия:
- Понятие и устройство интерфейса
- Пустой интерфейс
- Проверка типа интерфейса
- Важные интерфейсы
- Обобщённое программирование (Generics)
___
<h5>Понятие и устройство интерфейса</h5>
**Интерфейсные типы выражают обобщение или абстракцию поведения других типов** (Алан Донован).

Альтернативное определение: **интерфейс — это именованный набор сигнатур методов (контракт интерфейса)**.

Итого, интерфейс — это тип данных. Интерфейсный тип — это абстрактный тип данных, который определяет набор методов, которыми должен обладать конкретный тип, чтобы считаться экземпляром интерфейса.

Интерфейсы предназначены для придания нашему ПО гибкости в реализации и позволяют писать полиморфический (обобщённый) код.

В Go имеет место утиная типизация, подразумевающая, что интерфейсы выполняются неявно. Если наш тип данных реализовал контракт какого-либо интерфейса, то он автоматически стал удовлетворять этому интерфейсу, а мы можем даже этого не узнать.

Любой тип данных может реализовать контракт интерфейса.

> [!NOTE] Слово об интерфейсе
> The bigger interface — the weaker abstraction

У хорошего интерфейса должно быть небольшое количество методов, и чем меньше в интерфейсе методов, тем более абстрактным он является, так как ему могут удовлетворить больше сущностей.

https://golang.org/ref/spec#Interface_types
Интерфейс — структура, описанная в пакете "runtime" (https://pkg.go.dev/runtime)
Интерфейс — неэкспортируемая структура. Файл "runtime2.go":
```go
type iface struct {
	tab *itab           // указатель на таблицу с типом значения и его методами
	data unsafe.Pointer // указатель на конкретное значение
}
```

Переменная интерфейсного типа является экземпляром структуры `iface` и по умолчанию в качестве значений обоих полей содержит `nil`.

После присвоения интерфейсу некоторого значения:
- поле `tab` будет ссылаться на таблицу, в которой содержится тип значения и полный список его методов с типом получателя;
- поле `data` будет ссылаться на само присвоенное значение.

Интерфейс это ссылочный тип данных, представляющий из себя структуру, следовательно, его значением по умолчанию является nil.
___
<h5>Хитрость пустого интерфейса (вопрос на собес)</h5>

___
<h5>Почему нельзя передать адрес на константу в Go?</h5>
Почему нельзя сделать так:
```go
const a = "mystring"
p := &a
```
и так:
```go
p := &"mystring"
```
, а!?

Константы в Go оптимизированы! Это значит, что одна и та же константа, написанная в коде, будет храниться по одному и тому же адресу, являясь одним и тем же объектом:
```go
const (
	a = 10
	b = 10
	c = 10
)
```
Здесь, у трёх переменных a, b и c будет один и тот же адрес.

Оптимизация констант выполнена для оптимизации потребления памяти приложением, что выглядит как хорошая и логичная идея - если мы используем одно и то же неизменное значение в разных местах, почему бы не сохранить его в памяти лишь однажды?
___
<h5>Пустой интерфейс</h5>
> Бытует мнение, что интерфейсы в Go это вторая по сложности тема, после конкурентного программирования.
> Некоторые считают, что интерфейсы в Go перегружены в смысловом плане:
> 	С одной стороны, интерфейсы необходимы для реализации полиморфического поведения и служит для моделирования нашей системы. 
> 	С другой стороны, существует пустой интерфейс, который служит совершенно иным целям, представляя контейнер для произвольного типа данных.

Пустой интерфейс был предложен авторами языка для использования в качестве контейнеров для любого типа (любой тип данных удовлетворяет пустому интерфейсу).
<h6>Теория</h6>
Пустой интерфейс — интерфейс, имеющий пустой контракт, и служащий контейнером для любого типа данных.
Пустой интерфейс используется в утилитах, работающих с данными произвольного типа:
- форматированный вывод (fmt, log)
- кодирование и декодирование (json, xml, gob)
- сортировка (sort)
- и т.д.

Механизм, с помощью которого функция может работать с данными разных типов, называется полиморфизмом.